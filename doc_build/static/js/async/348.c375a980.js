(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["348"],{6231:function(e,n,r){"use strict";r.r(n);var s=r("2676"),a=r("453"),t=r("5962");function c(e){let n=Object.assign({h1:"h1",a:"a",div:"div",p:"p",h3:"h3",ul:"ul",li:"li",pre:"pre",code:"code"},(0,a.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"json-\u5BFC\u51FA-xlsx",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#json-\u5BFC\u51FA-xlsx",children:"#"}),"JSON \u5BFC\u51FA xlsx"]}),"\n","\n",(0,s.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,s.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsxs)(n.div,{className:"rspress-directive-content",children:[(0,s.jsx)(n.p,{children:"\u672C\u6848\u4F8B\u53EA\u662F\u4E00\u4E2A Demo\uFF0C\u6EE1\u8DB3\u4E2A\u4EBA\u573A\u666F\u4F7F\u7528\uFF0C\u7ECF\u6D4B\u8BD5\u53EF\u4EE5\u628A JSON \u6570\u636E\u5BFC\u51FA\u4E3A Excel \u6587\u4EF6"}),(0,s.jsx)(n.p,{children:"\u5177\u4F53\u4EE3\u7801\u903B\u8F91\u9700\u8981\u6839\u636E\u5B9E\u9645\u4E1A\u52A1\u8FDB\u884C\u8C03\u6574"}),(0,s.jsx)(n.p,{children:"\u4EE3\u7801\u6267\u884C\u73AF\u5883\u4E3A nodejs"})]})]}),"\n",(0,s.jsxs)(n.h3,{id:"\u4E1A\u52A1\u573A\u666F",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4E1A\u52A1\u573A\u666F",children:"#"}),"\u4E1A\u52A1\u573A\u666F"]}),"\n",(0,s.jsx)(n.p,{children:"\u5C06\u4EE3\u7801\u4E2D\u914D\u7F6E\u597D\u7684 JSON \u6570\u636E\u5BFC\u51FA\u751F\u6210 Excel \u7C7B\u578B\u7684\u6587\u4EF6"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7FFB\u8BD1\u591A\u8BED\u8A00\u4F5C\u4E3A\u6E90\u6587\u4EF6\u63D0\u4F9B"}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"\u5B89\u88C5",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u5B89\u88C5",children:"#"}),"\u5B89\u88C5"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/mgcrea/node-xlsx#readme%22",target:"_blank",rel:"noopener noreferrer",children:"Github \u5730\u5740"})}),"\n",(0,s.jsx)(t.PackageManagerTabs,{command:{npm:"npm install node-xlsx --save",pnpm:"pnpm add node-xlsx"}}),"\n",(0,s.jsxs)(n.h3,{id:"\u6E90\u6570\u636E",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u6E90\u6570\u636E",children:"#"}),"\u6E90\u6570\u636E"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",meta:'title="data.json"',children:'{\r\n  "common": {\r\n    "region": {\r\n      "global": "Global",\r\n      "china": "China",\r\n      "russia": "Russia",\r\n      "singapore": "Singapore",\r\n      "th": "Thailand"\r\n    },\r\n    "remove": "Remove",\r\n    "language": "Language"\r\n  }\r\n  // ...\r\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"\u8F6C\u6362\u65B9\u6CD5",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u8F6C\u6362\u65B9\u6CD5",children:"#"}),"\u8F6C\u6362\u65B9\u6CD5"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",meta:'title="index.js" {21,24}',children:'const fs = require("fs");\r\nconst xlsx = require("node-xlsx");\r\n\r\nfunction flattenObject(obj, prefix = "") {\r\n  const result = {};\r\n\r\n  for (const key in obj) {\r\n    if (obj.hasOwnProperty(key) && typeof obj[key] === "object" && obj[key] !== null) {\r\n      const newPrefix = prefix ? `${prefix}.${key}` : key;\r\n      Object.assign(result, flattenObject(obj[key], newPrefix));\r\n    } else {\r\n      result[prefix ? `${prefix}.${key}` : key] = obj[key];\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n// \u8F6C\u5316\u9700\u8981\u65F6\u6570\u7EC4\uFF0C[\'\',\'\']\r\nconst excelDate = [["key", "en", "zh"]]; //\u8FD9\u91CC\u5C31\u662Fexcel\u7684\u8868\u5934\u7684\u503C\r\n// \u8BFB\u53D6\u5BF9\u5E94JSON\u6587\u4EF6\r\nconst zhLangStr = fs.readFileSync("./en.json", "utf-8");\r\nconst zhLangObj = JSON.parse(zhLangStr);\r\n// \u82F1\u6587\r\nconst enLangStr = fs.readFileSync("./zh-CN.json", "utf-8");\r\nconst enLangObj = JSON.parse(enLangStr);\r\n\r\nlet zh = flattenObject(zhLangObj);\r\nlet en = flattenObject(enLangObj);\r\n\r\n// \u904D\u5386\u4ED6\u7684key\uFF0C\u7136\u540E\u5F80excelDate\u4E2Dpush\u5B83\u7684key\u548Cvaule[\'\',\'\']\r\nObject.keys(zh).forEach((key) => {\r\n  Object.keys(en).forEach((key1) => {\r\n    if (key == key1) {\r\n      excelDate.push([key, zh[key], en[key]]);\r\n    }\r\n  });\r\n});\r\n\r\n// \u8BBE\u7F6E\u5217\u5BBD \u7B2C\u4E00\u5217\u548C\u7B2C\u4E8C\u5217 \u90FD\u662F30\r\nconst sheetOptions = { "!cols": [{ wch: 30 }, { wch: 30 }] };\r\nconst bufferZh = xlsx.build([{ name: "Sheet1", data: excelDate }], {\r\n  sheetOptions,\r\n});\r\n// \u5BFC\u51FA\u751F\u6210\u6587\u4EF6\r\nfs.writeFileSync("./zh.xlsx", bufferZh, { flag: "w" });\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"\u4F7F\u7528",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#\u4F7F\u7528",children:"#"}),"\u4F7F\u7528"]}),"\n",(0,s.jsxs)(n.p,{children:["\u8FD0\u884C\u547D\u4EE4\u6210\u529F\u540E\uFF0C\u540E\u751F\u6210",(0,s.jsx)(n.code,{children:"zh.xlsx"}),"\u6587\u4EF6"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",meta:"",children:"node index.js\n"})})]})}function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(c,e)})):c(e)}n.default=i,i.__RSPRESS_PAGE_META={},i.__RSPRESS_PAGE_META["home%2Feg%2F3.mdx"]={toc:[{id:"\u4E1A\u52A1\u573A\u666F",text:"\u4E1A\u52A1\u573A\u666F",depth:3},{id:"\u5B89\u88C5",text:"\u5B89\u88C5",depth:3},{id:"\u6E90\u6570\u636E",text:"\u6E90\u6570\u636E",depth:3},{id:"\u8F6C\u6362\u65B9\u6CD5",text:"\u8F6C\u6362\u65B9\u6CD5",depth:3},{id:"\u4F7F\u7528",text:"\u4F7F\u7528",depth:3}],title:"JSON \u5BFC\u51FA xlsx",frontmatter:{}}}}]);