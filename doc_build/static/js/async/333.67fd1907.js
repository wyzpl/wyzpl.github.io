"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["333"],{8186:function(e,n,r){r.r(n),r.d(n,{default:()=>c});var s=r(5893),a=r(65),t=r(5293);function i(e){let n=Object.assign({h1:"h1",a:"a",div:"div",p:"p",h3:"h3",ul:"ul",li:"li",pre:"pre",code:"code"},(0,a.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.h1,{id:"json-导出-xlsx",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#json-导出-xlsx",children:"#"}),"JSON 导出 xlsx"]}),"\n","\n",(0,s.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,s.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,s.jsxs)(n.div,{className:"rspress-directive-content",children:[(0,s.jsx)(n.p,{children:"本案例只是一个 Demo，满足个人场景使用，经测试可以把 JSON 数据导出为 Excel 文件"}),(0,s.jsx)(n.p,{children:"具体代码逻辑需要根据实际业务进行调整"}),(0,s.jsx)(n.p,{children:"代码执行环境为 nodejs"})]})]}),"\n",(0,s.jsxs)(n.h3,{id:"业务场景",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#业务场景",children:"#"}),"业务场景"]}),"\n",(0,s.jsx)(n.p,{children:"将代码中配置好的 JSON 数据导出生成 Excel 类型的文件"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"翻译多语言作为源文件提供"}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"安装",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装",children:"#"}),"安装"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/mgcrea/node-xlsx#readme%22",rel:"noopener noreferrer",target:"_blank",children:"Github 地址"})}),"\n",(0,s.jsx)(t.PackageManagerTabs,{command:{npm:"npm install node-xlsx --save",pnpm:"pnpm add node-xlsx"}}),"\n",(0,s.jsxs)(n.h3,{id:"源数据",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#源数据",children:"#"}),"源数据"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",meta:'title="data.json"',children:'{\r\n  "common": {\r\n    "region": {\r\n      "global": "Global",\r\n      "china": "China",\r\n      "russia": "Russia",\r\n      "singapore": "Singapore",\r\n      "th": "Thailand"\r\n    },\r\n    "remove": "Remove",\r\n    "language": "Language"\r\n  }\r\n  // ...\r\n}\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"转换方法",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#转换方法",children:"#"}),"转换方法"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",meta:'title="index.js" {21,24}',children:'const fs = require("fs");\r\nconst xlsx = require("node-xlsx");\r\n\r\nfunction flattenObject(obj, prefix = "") {\r\n  const result = {};\r\n\r\n  for (const key in obj) {\r\n    if (obj.hasOwnProperty(key) && typeof obj[key] === "object" && obj[key] !== null) {\r\n      const newPrefix = prefix ? `${prefix}.${key}` : key;\r\n      Object.assign(result, flattenObject(obj[key], newPrefix));\r\n    } else {\r\n      result[prefix ? `${prefix}.${key}` : key] = obj[key];\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n// 转化需要时数组，[\'\',\'\']\r\nconst excelDate = [["key", "en", "zh"]]; //这里就是excel的表头的值\r\n// 读取对应JSON文件\r\nconst zhLangStr = fs.readFileSync("./en.json", "utf-8");\r\nconst zhLangObj = JSON.parse(zhLangStr);\r\n// 英文\r\nconst enLangStr = fs.readFileSync("./zh-CN.json", "utf-8");\r\nconst enLangObj = JSON.parse(enLangStr);\r\n\r\nlet zh = flattenObject(zhLangObj);\r\nlet en = flattenObject(enLangObj);\r\n\r\n// 遍历他的key，然后往excelDate中push它的key和vaule[\'\',\'\']\r\nObject.keys(zh).forEach((key) => {\r\n  Object.keys(en).forEach((key1) => {\r\n    if (key == key1) {\r\n      excelDate.push([key, zh[key], en[key]]);\r\n    }\r\n  });\r\n});\r\n\r\n// 设置列宽 第一列和第二列 都是30\r\nconst sheetOptions = { "!cols": [{ wch: 30 }, { wch: 30 }] };\r\nconst bufferZh = xlsx.build([{ name: "Sheet1", data: excelDate }], {\r\n  sheetOptions,\r\n});\r\n// 导出生成文件\r\nfs.writeFileSync("./zh.xlsx", bufferZh, { flag: "w" });\n'})}),"\n",(0,s.jsxs)(n.h3,{id:"使用",children:[(0,s.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用",children:"#"}),"使用"]}),"\n",(0,s.jsxs)(n.p,{children:["运行命令成功后，后生成",(0,s.jsx)(n.code,{children:"zh.xlsx"}),"文件"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"node index.js\n"})})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,s.jsx)(n,Object.assign({},e,{children:(0,s.jsx)(i,e)})):i(e)}let c=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["web%2Fdev%2F3.mdx"]={toc:[{id:"业务场景",text:"业务场景",depth:3},{id:"安装",text:"安装",depth:3},{id:"源数据",text:"源数据",depth:3},{id:"转换方法",text:"转换方法",depth:3},{id:"使用",text:"使用",depth:3}],title:"JSON 导出 xlsx",headingTitle:"JSON 导出 xlsx",frontmatter:{}}}}]);