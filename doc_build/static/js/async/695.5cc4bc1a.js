"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["695"],{2748:function(n,i,e){e.r(i),e.d(i,{default:()=>o});var t=e(5893),r=e(65);function a(n){let i=Object.assign({h1:"h1",a:"a",div:"div",p:"p",code:"code",h2:"h2",pre:"pre"},(0,r.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.h1,{id:"app-如何打开应用通知权限",children:[(0,t.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#app-如何打开应用通知权限",children:"#"}),"APP 如何打开应用通知权限"]}),"\n",(0,t.jsxs)(i.div,{className:"rspress-directive warning",children:[(0,t.jsx)(i.div,{className:"rspress-directive-title",children:"注意"}),(0,t.jsx)(i.div,{className:"rspress-directive-content",children:(0,t.jsxs)(i.p,{children:["\n本文章使用 uniapp 开发，使用了",(0,t.jsx)(i.code,{children:"plus"}),"。如果涉及多端，需进行条件编译"]})})]}),"\n",(0,t.jsxs)(i.h2,{id:"获取通知权限状态",children:[(0,t.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#获取通知权限状态",children:"#"}),"获取通知权限状态"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-js",children:'function getNotificationStatus() {\r\n  console.log(platform);\r\n  if (platform == "ios") {\r\n    //这里是ios的方法\r\n    var UIApplication = plus.ios.import("UIApplication");\r\n    var app = UIApplication.sharedApplication();\r\n    if (app.currentUserNotificationSettings) {\r\n      var settings = app.currentUserNotificationSettings();\r\n      enabledTypes = settings.plusGetAttribute("types");\r\n      console.log("enabledTypes1:" + enabledTypes);\r\n      //如果enabledTypes = 0 就是通知权限没有开启\r\n      plus.ios.deleteObject(settings);\r\n      return enabledTypes;\r\n    }\r\n  } else if (platform == "android") {\r\n    //下面是安卓的方法\r\n    var main = plus.android.runtimeMainActivity();\r\n    var pkName = main.getPackageName();\r\n    var uid = main.getApplicationInfo().plusGetAttribute("uid");\r\n    var NotificationManagerCompat = plus.android.importClass("android.support.v4.app.NotificationManagerCompat");\r\n    //android.support.v4升级为androidx\r\n    if (NotificationManagerCompat == null) {\r\n      NotificationManagerCompat = plus.android.importClass("androidx.core.app.NotificationManagerCompat");\r\n    }\r\n    var areNotificationsEnabled = NotificationManagerCompat.from(main).areNotificationsEnabled();\r\n    console.log(areNotificationsEnabled);\r\n    return areNotificationsEnabled;\r\n    // 未开通‘允许通知’权限，则弹窗提醒开通，并点击确认后，跳转到系统设置页面进行设置\r\n  }\r\n}\n'})}),"\n",(0,t.jsxs)(i.h2,{id:"跳转通知权限设置",children:[(0,t.jsx)(i.a,{className:"header-anchor","aria-hidden":"true",href:"#跳转通知权限设置",children:"#"}),"跳转通知权限设置"]}),"\n",(0,t.jsx)(i.p,{children:"Android 可以直接跳转通知设置页面。ios 需要跳转设置页面后在手动进入通知设置"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-js",children:"function openNotificationSetting() {\r\n	//弹窗按钮绑定方法\r\n	if (platform == 'ios') {\r\n		//如果机型是ios，ios由于权限问题，可能需要手动开启\r\n		var UIApplication = plus.ios.import('UIApplication')\r\n		var app = UIApplication.sharedApplication()\r\n		var settings = app.currentUserNotificationSettings()\r\n		enabledTypes = settings.plusGetAttribute('types')\r\n		var NSURL2 = plus.ios.import('NSURL')\r\n		var setting2 = NSURL2.URLWithString('app-settings:')\r\n		var application2 = UIApplication.sharedApplication()\r\n		application2.openURL(setting2)\r\n		plus.ios.deleteObject(setting2)\r\n		plus.ios.deleteObject(NSURL2)\r\n		plus.ios.deleteObject(application2)\r\n		plus.ios.deleteObject(settings)\r\n	} else if (platform == 'android') {\r\n		//如果机型是安卓\r\n		var main = plus.android.runtimeMainActivity()\r\n		var pkName = main.getPackageName()\r\n		var uid = main.getApplicationInfo().plusGetAttribute('uid')\r\n		var Intent = plus.android.importClass('android.content.Intent')\r\n		var Build = plus.android.importClass('android.os.Build')\r\n		//android 8.0引导\r\n		if (Build.VERSION.SDK_INT >= 26) {\r\n			//判断安卓系统版本\r\n			var intent = new Intent('android.settings.APP_NOTIFICATION_SETTINGS')\r\n			intent.putExtra('android.provider.extra.APP_PACKAGE', pkName)\r\n		} else if (Build.VERSION.SDK_INT >= 21) {\r\n			//判断安卓系统版本\r\n			//android 5.0-7.0\r\n			var intent = new Intent('android.settings.APP_NOTIFICATION_SETTINGS')\r\n			intent.putExtra('app_package', pkName)\r\n			intent.putExtra('app_uid', uid)\r\n		} else {\r\n			//(<21)其他--跳转到该应用管理的详情页\r\n			intent.setAction(Settings.ACTION_APPLICATION_DETAILS_SETTINGS)\r\n			var uri = Uri.fromParts('package', mainActivity.getPackageName(), null)\r\n			intent.setData(uri)\r\n		}\r\n		// 跳转到该应用的系统通知设置页\r\n		main.startActivity(intent)\r\n	}\n"})})]})}function s(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:i}=Object.assign({},(0,r.ah)(),n.components);return i?(0,t.jsx)(i,Object.assign({},n,{children:(0,t.jsx)(a,n)})):a(n)}let o=s;s.__RSPRESS_PAGE_META={},s.__RSPRESS_PAGE_META["web%2Fdev%2F1.mdx"]={toc:[{id:"获取通知权限状态",text:"获取通知权限状态",depth:2},{id:"跳转通知权限设置",text:"跳转通知权限设置",depth:2}],title:"APP 如何打开应用通知权限",headingTitle:"APP 如何打开应用通知权限",frontmatter:{}}}}]);