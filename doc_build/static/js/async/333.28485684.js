"use strict";(self.webpackChunkrspress_doc_template=self.webpackChunkrspress_doc_template||[]).push([["333"],{8186:function(e,n,s){s.r(n),s.d(n,{default:()=>c});var r=s(5893),a=s(65),t=s(5293);function i(e){let n=Object.assign({h1:"h1",a:"a",div:"div",p:"p",h3:"h3",ul:"ul",li:"li",pre:"pre",code:"code"},(0,a.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"json-导出-xlsx",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#json-导出-xlsx",children:"#"}),"JSON 导出 xlsx"]}),"\n","\n",(0,r.jsxs)(n.div,{className:"rspress-directive tip",children:[(0,r.jsx)(n.div,{className:"rspress-directive-title",children:"TIP"}),(0,r.jsxs)(n.div,{className:"rspress-directive-content",children:[(0,r.jsx)(n.p,{children:"本案例只是一个 Demo，满足个人场景使用，经测试可以把 JSON 数据导出为 Excel 文件"}),(0,r.jsx)(n.p,{children:"具体代码逻辑需要根据实际业务进行调整"}),(0,r.jsx)(n.p,{children:"代码执行环境为 nodejs"})]})]}),"\n",(0,r.jsxs)(n.h3,{id:"业务场景",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#业务场景",children:"#"}),"业务场景"]}),"\n",(0,r.jsx)(n.p,{children:"将代码中配置好的 JSON 数据导出生成 Excel 类型的文件"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"翻译多语言作为源文件提供"}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"安装",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装",children:"#"}),"安装"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/mgcrea/node-xlsx#readme%22",rel:"noopener noreferrer",target:"_blank",children:"Github 地址"})}),"\n",(0,r.jsx)(t.PackageManagerTabs,{command:{npm:"npm install node-xlsx --save",pnpm:"pnpm add node-xlsx"}}),"\n",(0,r.jsxs)(n.h3,{id:"源数据",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#源数据",children:"#"}),"源数据"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",meta:'title="data.json"',children:'{\n  "common": {\n    "region": {\n      "global": "Global",\n      "china": "China",\n      "russia": "Russia",\n      "singapore": "Singapore",\n      "th": "Thailand"\n    },\n    "remove": "Remove",\n    "language": "Language"\n  }\n  // ...\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"转换方法",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#转换方法",children:"#"}),"转换方法"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",meta:'title="index.js" {21,24}',children:'const fs = require("fs");\nconst xlsx = require("node-xlsx");\n\nfunction flattenObject(obj, prefix = "") {\n  const result = {};\n\n  for (const key in obj) {\n    if (obj.hasOwnProperty(key) && typeof obj[key] === "object" && obj[key] !== null) {\n      const newPrefix = prefix ? `${prefix}.${key}` : key;\n      Object.assign(result, flattenObject(obj[key], newPrefix));\n    } else {\n      result[prefix ? `${prefix}.${key}` : key] = obj[key];\n    }\n  }\n\n  return result;\n}\n// 转化需要时数组，[\'\',\'\']\nconst excelDate = [["key", "en", "zh"]]; //这里就是excel的表头的值\n// 读取对应JSON文件\nconst zhLangStr = fs.readFileSync("./en.json", "utf-8");\nconst zhLangObj = JSON.parse(zhLangStr);\n// 英文\nconst enLangStr = fs.readFileSync("./zh-CN.json", "utf-8");\nconst enLangObj = JSON.parse(enLangStr);\n\nlet zh = flattenObject(zhLangObj);\nlet en = flattenObject(enLangObj);\n\n// 遍历他的key，然后往excelDate中push它的key和vaule[\'\',\'\']\nObject.keys(zh).forEach((key) => {\n  Object.keys(en).forEach((key1) => {\n    if (key == key1) {\n      excelDate.push([key, zh[key], en[key]]);\n    }\n  });\n});\n\n// 设置列宽 第一列和第二列 都是30\nconst sheetOptions = { "!cols": [{ wch: 30 }, { wch: 30 }] };\nconst bufferZh = xlsx.build([{ name: "Sheet1", data: excelDate }], {\n  sheetOptions,\n});\n// 导出生成文件\nfs.writeFileSync("./zh.xlsx", bufferZh, { flag: "w" });\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"使用",children:[(0,r.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用",children:"#"}),"使用"]}),"\n",(0,r.jsxs)(n.p,{children:["运行命令成功后，后生成",(0,r.jsx)(n.code,{children:"zh.xlsx"}),"文件"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"node index.js\n"})})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,r.jsx)(n,Object.assign({},e,{children:(0,r.jsx)(i,e)})):i(e)}let c=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["web%2Fdev%2F3.mdx"]={toc:[{id:"业务场景",text:"业务场景",depth:3},{id:"安装",text:"安装",depth:3},{id:"源数据",text:"源数据",depth:3},{id:"转换方法",text:"转换方法",depth:3},{id:"使用",text:"使用",depth:3}],title:"JSON 导出 xlsx",headingTitle:"JSON 导出 xlsx",frontmatter:{}}}}]);